# Kekeling 小程序 MVP 紧急上线执行计划

> 版本：v1.0  
> 更新日期：2024年12月  
> 目标：6 周内完成微信小程序 MVP 上线

---

## 一、MVP 范围定义

### 1.1 必须保留的核心功能 🔴

| 模块 | 功能 | 说明 |
|------|------|------|
| **首页** | Banner 轮播 | 产品中心配置 |
| | 服务入口 | 快速导航到各类服务 |
| | 热门服务 | 展示热门服务推荐 |
| **服务** | 服务列表 | 按分类浏览、搜索 |
| | 服务详情 | 服务介绍、价格、立即预约 |
| **医院** | 医院列表 | 支持搜索、位置排序 |
| | 医院详情 | 医院信息展示 |
| **陪诊员** | 陪诊员列表 | 筛选、排序 |
| | 陪诊员详情 | 简介、评价、预约 |
| **订单** | 下单页面 | 选择服务→医院→陪诊员→就诊人 |
| | 微信支付 | 小程序支付对接 |
| | 订单列表 | 查看所有订单 |
| | 订单详情 | 订单状态、进度、联系方式 |
| | 取消订单 | 待支付/待确认可取消 |
| **个人中心** | 微信登录 | 一键授权 |
| | 手机绑定 | 获取微信手机号 |
| | 就诊人管理 | 添加/编辑/删除就诊人 |

### 1.2 暂时搁置的功能 ✂️

| 功能 | 原计划版本 | 暂缓原因 |
|------|-----------|---------|
| IM 聊天/在线客服 | v1.1 | 技术复杂度高，初期用电话代替 |
| 积分商城 | v1.2 | 非核心交易流程 |
| 邀请有礼 | v1.2 | 营销功能，后续迭代 |
| 优惠券 | v1.1 | 简化首版，降低复杂度 |
| 复杂评价 | v1.1 | 初期简化为星级打分 |
| 收藏功能 | v1.2 | 非核心功能 |
| 消息推送 | v1.1 | 先用微信服务通知 |

---

## 二、并行开发执行策略

### 2.1 三条开发线

```
┌────────────────────────────────────────────────────────────────┐
│                        并行开发策略                              │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  线路 1: 小程序端 (Taro + React)                                │
│  ├── Week 1: 项目初始化、框架搭建                                │
│  ├── Week 2: 首页、登录、服务列表                                │
│  ├── Week 3: 医院列表、陪诊员列表                                │
│  ├── Week 4: 下单流程、支付页面                                  │
│  ├── Week 5: 订单管理、个人中心                                  │
│  └── Week 6: 联调、测试、提审                                    │
│                                                                │
│  线路 2: 后端 API (Node.js / 云开发)                            │
│  ├── Week 1: 项目搭建、数据库设计                                │
│  ├── Week 2: 认证接口、用户接口                                  │
│  ├── Week 3: 服务/医院/陪诊员接口                                │
│  ├── Week 4: 订单接口、支付对接                                  │
│  ├── Week 5: 管理后台接口对接                                    │
│  └── Week 6: 联调、优化、部署                                    │
│                                                                │
│  线路 3: 管理后台改造                                            │
│  ├── Week 3: 对接真实 API（停用 Mock）                           │
│  ├── Week 4: 订单处理功能完善（派单）                             │
│  ├── Week 5: 陪诊员管理、配置管理                                │
│  └── Week 6: 联调测试                                           │
│                                                                │
└────────────────────────────────────────────────────────────────┘
```

### 2.2 共享资源

已创建的共享类型包 `@kekeling/shared-types` 包含：

```
packages/shared-types/
├── src/
│   ├── index.ts      # 统一导出
│   ├── common.ts     # 通用类型（分页、状态、位置等）
│   ├── user.ts       # 用户相关（C端用户、就诊人、管理员）
│   ├── order.ts      # 订单相关（订单、支付、状态流转）
│   ├── service.ts    # 服务相关（服务、分类、价格策略）
│   ├── escort.ts     # 陪诊员相关
│   ├── medical.ts    # 医疗资源（医院、科室、医生）
│   └── api.ts        # API 响应格式、登录、首页配置
├── package.json
└── tsconfig.json
```

**使用方式：**

```typescript
// 小程序端
import { Order, Service, Escort } from '@kekeling/shared-types'

// 后端
import { orderSchema, createOrderRequestSchema } from '@kekeling/shared-types'
```

---

## 三、外部依赖检查清单 ⚠️

> **重要：** 这些通常是卡住上线的非技术因素，请立即确认！

### 3.1 微信小程序账号

- [ ] 已注册企业认证小程序账号
- [ ] 已完成微信认证（年审）
- [ ] 已获取 AppID 和 AppSecret
- [ ] 已添加开发者账号

**负责人：_______ 截止日期：_______**

### 3.2 微信支付

- [ ] 已开通微信支付商户号
- [ ] 商户号已关联小程序 AppID
- [ ] 已获取 API 密钥
- [ ] 已配置支付目录和授权域名
- [ ] 已完成沙箱环境测试

**负责人：_______ 截止日期：_______**

### 3.3 服务器/域名

- [ ] 已购买云服务器（推荐：阿里云/腾讯云）
- [ ] 已购买域名
- [ ] **已完成 ICP 备案**（⚠️ 通常需要 10-20 天）
- [ ] 已配置 HTTPS 证书
- [ ] 已在小程序后台配置服务器域名

**负责人：_______ 截止日期：_______**

### 3.4 行业资质

- [ ] 已确认小程序类目（医疗/陪诊/生活服务）
- [ ] 已准备相关行业资质证明
- [ ] 已了解类目审核要求

**负责人：_______ 截止日期：_______**

### 3.5 其他资源

- [ ] 已准备产品 Logo / 品牌素材
- [ ] 已准备服务介绍内容
- [ ] 已准备用户协议/隐私政策
- [ ] 已准备测试数据（医院、服务、陪诊员）

---

## 四、详细周计划

### Week 1：项目初始化

**小程序端：**
- [ ] 初始化 Taro 项目
- [ ] 配置 NutUI-React 组件库
- [ ] 搭建项目目录结构
- [ ] 封装请求工具、状态管理
- [ ] 完成基础布局（TabBar、导航）

**后端：**
- [ ] 技术选型确认（Node.js/云开发）
- [ ] 数据库设计
- [ ] 项目初始化
- [ ] 基础中间件（认证、错误处理、日志）

**管理后台：**
- [ ] 安装共享类型包
- [ ] 确认需要对接的接口清单

### Week 2：首页与登录

**小程序端：**
- [ ] 首页 UI 实现
- [ ] 微信登录流程
- [ ] 手机号绑定
- [ ] 服务列表页面

**后端：**
- [ ] 微信登录接口
- [ ] 用户信息接口
- [ ] 首页配置接口
- [ ] 服务列表接口

### Week 3：核心列表页

**小程序端：**
- [ ] 服务详情页
- [ ] 医院列表/详情页
- [ ] 陪诊员列表/详情页
- [ ] 搜索功能

**后端：**
- [ ] 医院接口（列表/详情）
- [ ] 陪诊员接口（列表/详情）
- [ ] 搜索接口

**管理后台：**
- [ ] 替换 Mock 数据为真实 API

### Week 4：下单与支付

**小程序端：**
- [ ] 下单页面（完整流程）
- [ ] 就诊人选择/添加
- [ ] 支付页面
- [ ] 支付结果页

**后端：**
- [ ] 创建订单接口
- [ ] 微信支付对接
- [ ] 支付回调处理
- [ ] 就诊人管理接口

**管理后台：**
- [ ] 订单列表对接真实数据
- [ ] 订单详情完善

### Week 5：订单管理

**小程序端：**
- [ ] 订单列表页（分 Tab）
- [ ] 订单详情页
- [ ] 取消订单功能
- [ ] 个人中心完善

**后端：**
- [ ] 订单列表/详情接口
- [ ] 取消订单接口
- [ ] 订单状态推送

**管理后台：**
- [ ] 派单功能（分配陪诊员）
- [ ] 订单状态更新

### Week 6：联调与发布

**小程序端：**
- [ ] 全流程联调测试
- [ ] Bug 修复
- [ ] 性能优化（分包）
- [ ] 提交审核

**后端：**
- [ ] 全接口联调
- [ ] 压力测试
- [ ] 生产环境部署

**管理后台：**
- [ ] 全流程测试
- [ ] 权限配置
- [ ] 生产环境部署

---

## 五、技术选型确认

### 5.1 后端方案选择

| 方案 | 优势 | 劣势 | 推荐场景 |
|------|------|------|---------|
| **微信云开发** | 免服务器、免备案、快速上线 | 厂商锁定、扩展性受限 | 时间紧、团队小 |
| **Node.js (Nest.js)** | 技术栈统一、灵活性高 | 需要服务器和备案 | 长期项目、有后端团队 |
| **Go / Java** | 性能好、企业级 | 学习成本高 | 大型项目 |

**推荐：** 如果 ICP 备案已完成或进行中，建议用 **Node.js**；如果时间非常紧且没有备案，考虑 **云开发** 快速上线。

### 5.2 数据库设计

```sql
-- 核心表结构
users           -- C端用户
patients        -- 就诊人
admin_users     -- 管理员
escorts         -- 陪诊员
services        -- 服务项目
service_categories -- 服务分类
hospitals       -- 医院
departments     -- 科室
orders          -- 订单
order_items     -- 订单服务项
payments        -- 支付记录
reviews         -- 评价
banners         -- 轮播图
app_configs     -- 应用配置
```

---

## 六、风险与应对

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|---------|
| **ICP 备案延迟** | 无法上线 | 高 | 考虑云开发过渡方案 |
| **微信审核不通过** | 延期上线 | 中 | 提前了解审核规范，预留时间 |
| **支付对接问题** | 核心功能阻塞 | 中 | 提前申请商户号，做好沙箱测试 |
| **后端人力不足** | 进度延期 | 中 | 考虑云开发或外包 |
| **需求变更** | 进度延期 | 高 | 严格控制 MVP 范围 |

---

## 七、下一步行动清单

### 立即执行（今天）

1. [ ] **确认后端资源**：是否有后端开发人员？
2. [ ] **确认备案状态**：域名是否已备案？
3. [ ] **确认支付资质**：微信支付商户号是否已申请？
4. [ ] **初始化 Taro 项目**：见下方命令

### 初始化 Taro 项目

```bash
# 在 kekeling 目录下创建小程序项目
cd /Users/aiden/Documents/app/kekeling

# 安装 Taro CLI
pnpm add -g @tarojs/cli

# 创建小程序项目
taro init miniapp-client

# 选择配置：
# - 框架: React
# - TypeScript: Yes
# - CSS 预处理器: Sass
# - 模板: 默认模板

# 进入项目安装依赖
cd miniapp-client
pnpm install

# 安装 NutUI
pnpm add @nutui/nutui-react-taro

# 安装共享类型
pnpm add ../packages/shared-types
```

---

**文档维护人：** Kekeling 技术团队  
**最后更新：** 2024-12-08

