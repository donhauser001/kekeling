# 营销中心测试执行清单

## 快速测试清单

### ✅ 基础功能测试

#### 会员系统
- [ ] 查看会员等级列表
- [ ] 购买会员
- [ ] 会员权益生效（价格折扣）
- [ ] 会员到期自动更新

#### 价格引擎
- [ ] 无折扣价格计算
- [ ] 会员折扣计算
- [ ] 优惠券折扣计算
- [ ] 积分抵扣计算
- [ ] 折扣叠加顺序正确
- [ ] 价格快照保存

#### 优惠券系统
- [ ] 领取优惠券
- [ ] 查看我的优惠券
- [ ] 下单使用优惠券
- [ ] 优惠券自动发放（注册/订单完成）

#### 积分系统
- [ ] 订单完成获得积分
- [ ] 每日签到获得积分
- [ ] 下单使用积分
- [ ] 查看积分明细

#### 邀请系统
- [ ] 查看我的邀请码
- [ ] 新用户使用邀请码注册
- [ ] 邀请奖励发放
- [ ] 查看邀请记录

#### 活动系统
- [ ] 查看活动列表
- [ ] 活动折扣生效
- [ ] 秒杀商品抢购
- [ ] 活动状态自动更新

### ✅ 退款测试

- [ ] 订单取消：优惠券退回
- [ ] 订单取消：积分退回
- [ ] 订单取消：秒杀库存释放
- [ ] 订单退款：优惠券退回
- [ ] 订单退款：积分退回
- [ ] 订单退款：秒杀库存释放

### ✅ 防刷测试

- [ ] 优惠券：每人限领
- [ ] 优惠券：每日限领
- [ ] 优惠券：总库存限制
- [ ] 积分：每日签到限制
- [ ] 邀请：自己邀请自己被拒绝
- [ ] 邀请：同一手机号重复邀请被拒绝
- [ ] 邀请：每日邀请数量限制
- [ ] 秒杀：库存控制
- [ ] 秒杀：每人限购

### ✅ 性能测试

- [ ] 价格计算接口响应时间 < 500ms
- [ ] 优惠券列表接口响应时间 < 300ms
- [ ] 活动列表接口响应时间 < 300ms
- [ ] 定时任务执行时间 < 5s

## 详细测试步骤

### 1. 会员购买流程测试

1. **准备**：确保有可用的会员等级和方案
2. **操作**：
   - 用户登录
   - 进入会员中心
   - 选择会员等级
   - 选择会员方案
   - 购买会员
   - 支付订单
3. **验证**：
   - 会员状态为 `active`
   - 会员到期时间正确
   - 下单时享受会员折扣

### 2. 价格计算测试

1. **准备**：准备测试数据
   - 服务价格：100元
   - 用户有会员（10%折扣）
   - 用户有优惠券（20元）
   - 用户有积分（5000积分=50元）
2. **操作**：调用价格计算接口
3. **验证**：
   - 原价：100元
   - 会员折扣后：90元
   - 优惠券折扣后：70元
   - 积分抵扣后：20元（最低支付金额）
   - 价格快照保存完整

### 3. 优惠券领取测试

1. **准备**：创建优惠券模板
   - 每人限领：2张
   - 每日限领：1张
   - 总库存：100张
2. **操作**：
   - 用户A领取1张（成功）
   - 用户A再次领取（失败：每日限领）
   - 用户A第二天领取（成功）
   - 用户A第三次领取（失败：每人限领）
3. **验证**：限制规则正确执行

### 4. 订单退款测试

1. **准备**：创建订单
   - 使用优惠券
   - 使用积分
   - 参与秒杀活动
2. **操作**：申请退款
3. **验证**：
   - 优惠券状态变为 `unused`
   - 积分余额增加
   - 秒杀库存增加

### 5. 防刷测试

1. **优惠券防刷**：
   - 尝试超过每人限领数量
   - 尝试超过每日限领数量
   - 尝试领取已售罄优惠券
2. **积分防刷**：
   - 尝试重复签到
   - 尝试使用超过余额的积分
3. **邀请防刷**：
   - 尝试自己邀请自己
   - 尝试重复邀请同一手机号
   - 尝试超过每日邀请数量

## 测试数据准备

### 测试用户
- 普通用户（无会员）
- 会员用户（有会员）
- 新用户（用于邀请测试）

### 测试优惠券
- 满减券（20元，满50元可用）
- 折扣券（8折，满100元可用）
- 免费券（0元，无门槛）

### 测试活动
- 限时特惠活动
- 秒杀活动（库存10件）

### 测试服务
- 服务A：100元
- 服务B：200元

## 测试环境

- **开发环境**：本地开发环境
- **测试数据库**：独立的测试数据库（可重置）

## 测试工具

- **API 测试**：Postman / Insomnia
- **性能测试**：Apache Bench (ab) / wrk
- **数据库查询**：Prisma Studio / pgAdmin

## 测试报告模板

### 测试结果

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 会员购买 | ✅/❌ | |
| 价格计算 | ✅/❌ | |
| 优惠券领取 | ✅/❌ | |
| 订单退款 | ✅/❌ | |
| 防刷机制 | ✅/❌ | |
| 性能测试 | ✅/❌ | |

### 发现的问题

1. **问题描述**
   - 严重程度：高/中/低
   - 复现步骤：
   - 预期结果：
   - 实际结果：

### 优化建议

1. **性能优化**
   - 建议添加缓存
   - 建议优化查询

2. **功能优化**
   - 建议增加功能
   - 建议改进体验

