# 确认弹窗规范

## 普通确认弹窗

```tsx
<ConfirmDialog
  open={open}
  onOpenChange={onOpenChange}
  handleConfirm={handleConfirm}
  title='确认操作'
  desc='确定要执行此操作吗？'
  confirmText='确认'
/>
```

---

## 危险操作确认弹窗（删除）

需要用户输入确认文本，防止误操作。

```tsx
import { AlertTriangle } from 'lucide-react'
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert'

<ConfirmDialog
  open={open}
  onOpenChange={onOpenChange}
  handleConfirm={handleDelete}
  disabled={inputValue.trim() !== expectedValue}
  title={
    <span className='text-destructive'>
      <AlertTriangle
        className='stroke-destructive me-1 inline-block'
        size={18}
      />
      删除项目
    </span>
  }
  desc={
    <div className='space-y-4'>
      <p className='mb-2'>
        确定要删除 <span className='font-bold'>{itemName}</span> 吗？
        <br />
        此操作无法恢复。
      </p>

      <Label className='my-2'>
        请输入名称确认：
        <Input
          value={inputValue}
          onChange={(e) => setInputValue(e.target.value)}
          placeholder='请输入名称以确认删除'
        />
      </Label>

      <Alert variant='destructive'>
        <AlertTitle>警告！</AlertTitle>
        <AlertDescription>
          请谨慎操作，此操作无法撤销。
        </AlertDescription>
      </Alert>
    </div>
  }
  confirmText='删除'
  destructive
/>
```

---

## ConfirmDialog Props

| 属性 | 类型 | 说明 |
|------|------|------|
| `open` | `boolean` | 弹窗开关状态 |
| `onOpenChange` | `(open: boolean) => void` | 状态变更回调 |
| `handleConfirm` | `() => void` | 确认按钮回调 |
| `title` | `React.ReactNode` | 标题（支持自定义样式） |
| `desc` | `React.JSX.Element \| string` | 描述内容 |
| `confirmText` | `React.ReactNode` | 确认按钮文本，默认 "确认" |
| `cancelBtnText` | `string` | 取消按钮文本，默认 "取消" |
| `destructive` | `boolean` | 是否为危险操作（红色按钮） |
| `disabled` | `boolean` | 是否禁用确认按钮 |
| `isLoading` | `boolean` | 是否加载中 |

---

## 使用场景

| 场景 | destructive | 输入确认 |
|------|------------|---------|
| 普通确认 | ❌ | ❌ |
| 删除单条数据 | ✅ | ❌ |
| 删除重要数据 | ✅ | ✅ |
| 批量删除 | ✅ | ✅ |
| 不可逆操作 | ✅ | ✅ |

---

## 脏表单关闭拦截

使用 `ConfirmDialog` 拦截未保存表单的关闭操作：

```tsx
const [confirmCloseOpen, setConfirmCloseOpen] = useState(false)

const onOpenChangeWrapper = (open: boolean) => {
  if (!open && form.formState.isDirty) {
    setConfirmCloseOpen(true)
    return
  }
  onOpenChange(open)
}

return (
  <>
    <Dialog open={open} onOpenChange={onOpenChangeWrapper}>
      {/* 弹窗内容 */}
    </Dialog>

    <ConfirmDialog
      open={confirmCloseOpen}
      onOpenChange={setConfirmCloseOpen}
      handleConfirm={() => {
        setConfirmCloseOpen(false)
        onOpenChange(false)
      }}
      title='放弃修改？'
      desc='您有未保存的修改，确定要关闭吗？'
      confirmText='放弃'
      destructive
    />
  </>
)
```
