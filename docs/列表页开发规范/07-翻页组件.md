# 翻页组件

## 使用 DataTablePagination

```tsx
import { DataTablePagination } from '@/components/data-table'

// 在表格组件底部，使用 mt-auto 固定在底部
<DataTablePagination table={table} className='mt-auto' />
```

---

## 固定底部规范

> ⚠️ **强制要求**：翻页组件必须使用 `className='mt-auto'` 固定在页面底部。

### 为什么需要 `mt-auto`？

配合 `Main` 的 `flex flex-1 flex-col` 布局，`mt-auto` 会将翻页组件推到容器底部：

```tsx
<Main className='flex flex-1 flex-col gap-4 sm:gap-6'>
  {/* 其他内容 */}
  
  {/* mt-auto 将翻页推到底部 */}
  <DataTablePagination table={table} className='mt-auto' />
</Main>
```

**效果：**
- 页面内容较少时，翻页组件仍在底部
- 页面内容较多时，翻页组件跟随内容
- 保证页面布局一致性

### 错误示例

```tsx
// ❌ 错误：没有 mt-auto，翻页不会固定底部
<DataTablePagination table={table} />

// ❌ 错误：Main 没有 flex 布局，mt-auto 无效
<Main>
  <DataTablePagination table={table} className='mt-auto' />
</Main>
```

### 正确示例

```tsx
// ✅ 正确
<Main className='flex flex-1 flex-col gap-4 sm:gap-6'>
  {/* 工具栏 */}
  <DataTableToolbar ... />
  
  {/* 表格 */}
  <ModuleTable ... />
  
  {/* 翻页（固定底部） */}
  <DataTablePagination table={table} className='mt-auto' />
</Main>
```

---

## 功能特性

- 显示总条数（共 xxx 条）
- 每页条数选择（10/20/30/40/50）
- 首页/上一页/下一页/末页按钮
- 当前页码/总页数显示

---

## 服务端分页配置

> ⚠️ **强制要求**：使用 `manualPagination: true` 时，**必须同时配置 `rowCount`**，否则分页组件无法显示总条数。

```tsx
const [page, setPage] = useState(1)
const [pageSize, setPageSize] = useState(10)

const { data } = useModuleData({ page, pageSize })
const total = data?.total || 0

const table = useReactTable({
  data: data?.data || [],
  columns,
  pageCount: Math.ceil(total / pageSize),
  rowCount: total,  // ⚠️ 必须：告诉表格总数据量，用于显示"共 xxx 条"
  state: {
    pagination: { pageIndex: page - 1, pageSize },
  },
  manualPagination: true,  // 服务端分页
  onPaginationChange: (updater) => {
    const newState = typeof updater === 'function'
      ? updater({ pageIndex: page - 1, pageSize })
      : updater
    setPage(newState.pageIndex + 1)
    setPageSize(newState.pageSize)
  },
  // ... 其他配置
})
```

### 配置说明

| 属性 | 类型 | 说明 |
|------|------|------|
| `pageCount` | `number` | 总页数，用于显示"第 x / y 页"和控制翻页按钮状态 |
| `rowCount` | `number` | **总行数**，用于显示"共 xxx 条" |
| `manualPagination` | `true` | 启用服务端分页（禁用客户端分页逻辑） |

> **常见错误**：只配置 `pageCount` 而忘记配置 `rowCount`，导致分页组件显示"共 0 条"或空白。

---

## 完整用法示例

```tsx
import { DataTablePagination } from '@/components/data-table'

export function ModulePage() {
  const [page, setPage] = useState(1)
  const [pageSize, setPageSize] = useState(10)

  const { data, isLoading } = useModuleData({ page, pageSize })
  const total = data?.total || 0

  const table = useReactTable({
    data: data?.data || [],
    columns,
    pageCount: Math.ceil(total / pageSize),
    rowCount: total,  // ⚠️ 必须配置
    state: {
      pagination: { pageIndex: page - 1, pageSize },
    },
    manualPagination: true,
    onPaginationChange: (updater) => {
      const newState = typeof updater === 'function'
        ? updater({ pageIndex: page - 1, pageSize })
        : updater
      setPage(newState.pageIndex + 1)
      setPageSize(newState.pageSize)
    },
    getCoreRowModel: getCoreRowModel(),
  })

  return (
    <Main className='flex flex-1 flex-col gap-4 sm:gap-6'>
      {/* 工具栏 */}
      <DataTableToolbar table={table} />
      
      {/* 表格 */}
      <div className='overflow-hidden rounded-md border'>
        <Table>...</Table>
      </div>
      
      {/* 翻页（固定底部） */}
      {!isLoading && data?.data?.length > 0 && (
        <DataTablePagination table={table} className='mt-auto' />
      )}
    </Main>
  )
}
```

---

## Props 说明

| 属性 | 类型 | 说明 |
|------|------|------|
| `table` | `Table<TData>` | useReactTable 返回的实例 |
| `className` | `string` | 自定义样式类，**必须包含 `mt-auto`** |

---

## 检查清单

- [ ] 使用 `DataTablePagination` 组件
- [ ] 添加 `className='mt-auto'` 固定底部
- [ ] `Main` 组件使用 `className='flex flex-1 flex-col gap-4 sm:gap-6'`
- [ ] 配置 `manualPagination: true` 启用服务端分页
- [ ] 正确设置 `pageCount`（总页数）
- [ ] **正确设置 `rowCount`**（总行数，用于显示"共 xxx 条"）
- [ ] 仅在有数据时显示翻页组件
