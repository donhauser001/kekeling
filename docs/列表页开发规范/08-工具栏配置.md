# 工具栏配置

## 使用 DataTableToolbar

```tsx
import { DataTableToolbar } from '@/components/data-table'

<DataTableToolbar
  table={table}
  searchPlaceholder='搜索...'
  searchKey='name'  // 指定搜索字段，不指定则全局搜索
  filters={[
    {
      columnId: 'status',
      title: '状态',           // 筛选按钮显示的中文名称
      options: [
        { label: '启用', value: 'active' },   // label: 下拉选项的中文名
        { label: '禁用', value: 'inactive' }, // value: 对应的数据值
      ],
    },
    {
      columnId: 'type',
      title: '类型',
      options: [
        { label: '限时特惠', value: 'flash_sale' },
        { label: '新人专享', value: 'newcomer' },
      ],
    },
  ]}
/>
```

---

## 工具栏功能

| 功能 | 组件 | 说明 |
|------|------|------|
| 搜索框 | `Input` | 支持指定字段或全局搜索 |
| 多选筛选器 | `FacetedFilter` | 按钮显示中文标题，支持多选 |
| 列显隐控制 | `ViewOptions` | 显示列的中文名称（需配置 `meta.title`） |
| 重置按钮 | `Button` | 有筛选条件时自动出现 |

---

## 显示列控制（ViewOptions）

「显示列」下拉菜单会列出所有可隐藏的列，列名显示规则：

1. **优先使用 `meta.title`**（推荐）
2. 如果 `header` 是字符串，使用该字符串
3. 最后使用 `column.id`（不推荐，会显示英文字段名）

```tsx
// ❌ 显示列菜单会显示 "type"
{
  accessorKey: 'type',
  header: ({ column }) => <DataTableColumnHeader column={column} title='类型' />,
}

// ✅ 显示列菜单会显示 "类型"
{
  accessorKey: 'type',
  header: ({ column }) => <DataTableColumnHeader column={column} title='类型' />,
  meta: { title: '类型' },  // 必须添加
}
```

> ⚠️ **强制要求**：每个列定义必须添加 `meta: { title: '中文名称' }`，详见 [04-列定义](./04-列定义.md)。

---

## 筛选器配置（Filters）

### FilterConfig 类型

```tsx
interface FilterConfig {
  columnId: string        // 对应列的 accessorKey 或 id
  title: string           // 筛选按钮显示的中文标题（如「状态」「类型」）
  options: {
    label: string         // 下拉选项的中文显示文本（如「启用」「禁用」）
    value: string         // 对应的数据值（如 'active', 'inactive'）
    icon?: ComponentType  // 可选：选项前的图标
  }[]
}
```

### 筛选器命名规范

| 配置项 | 说明 | 示例 |
|--------|------|------|
| `columnId` | 数据字段名（英文） | `'status'`, `'type'` |
| `title` | 按钮显示名（中文） | `'状态'`, `'类型'` |
| `options[].label` | 选项显示名（中文） | `'启用'`, `'限时特惠'` |
| `options[].value` | 选项数据值（英文） | `'active'`, `'flash_sale'` |

### 配置示例

```tsx
// 状态筛选器配置
const statusFilter = {
  columnId: 'status',      // 对应 accessorKey: 'status'
  title: '状态',           // 按钮显示「状态」
  options: [
    { label: '启用', value: 'active' },     // 显示「启用」，筛选 status === 'active'
    { label: '禁用', value: 'inactive' },   // 显示「禁用」，筛选 status === 'inactive'
    { label: '待审核', value: 'pending' },  // 显示「待审核」，筛选 status === 'pending'
  ],
}

// 类型筛选器配置（带图标）
const typeFilter = {
  columnId: 'type',
  title: '类型',
  options: [
    { label: '限时特惠', value: 'flash_sale', icon: Zap },
    { label: '新人专享', value: 'newcomer', icon: Gift },
    { label: '满减活动', value: 'threshold', icon: Tag },
  ],
}
```

---

## Props 说明

| 属性 | 类型 | 说明 |
|------|------|------|
| `table` | `Table<TData>` | useReactTable 返回的实例 |
| `searchPlaceholder` | `string` | 搜索框占位符（中文） |
| `searchKey` | `string` | 搜索字段，不指定则全局搜索 |
| `filters` | `FilterConfig[]` | 筛选器配置数组 |

---

## 完整示例

```tsx
import { DataTableToolbar } from '@/components/data-table'
import { CircleCheck, CircleX, Clock, Zap, Gift, Tag } from 'lucide-react'

// 状态筛选选项（带图标）
const statusOptions = [
  { label: '启用', value: 'active', icon: CircleCheck },
  { label: '禁用', value: 'inactive', icon: CircleX },
  { label: '待审核', value: 'pending', icon: Clock },
]

// 类型筛选选项
const typeOptions = [
  { label: '限时特惠', value: 'flash_sale', icon: Zap },
  { label: '新人专享', value: 'newcomer', icon: Gift },
  { label: '满减活动', value: 'threshold', icon: Tag },
]

<DataTableToolbar
  table={table}
  searchPlaceholder='搜索活动名称...'
  searchKey='name'
  filters={[
    { columnId: 'status', title: '状态', options: statusOptions },
    { columnId: 'type', title: '类型', options: typeOptions },
  ]}
/>
```

---

## 检查清单

- [ ] 每个列定义都添加了 `meta: { title: '中文名称' }`
- [ ] 筛选器的 `title` 使用中文（如「状态」而非「Status」）
- [ ] 筛选选项的 `label` 使用中文（如「启用」而非「Active」）
- [ ] 搜索框占位符使用中文（如「搜索活动名称...」）
