# 操作列菜单

所有列表页必须包含"操作"列，且必须包含 **查看**、**编辑**、**删除** 三个基础操作。

## 排序与分组规范

| 顺序 | 操作 | 组件 | 说明 |
|------|------|------|------|
| 1 | 查看 (View) | Sheet | 打开详情抽屉 |
| 2 | 编辑 (Edit) | Dialog | 打开编辑弹窗 |
| 3 | 业务操作 | - | 视具体业务而定（上架/下架、复制、审核等） |
| - | 分割线 | Separator | 在危险操作前必须添加 |
| 4 | 删除 (Delete) | ConfirmDialog | 红色警示样式 |

---

## 交互规范

- **阻止冒泡**：必须在 `DropdownMenuTrigger` 上阻止事件冒泡，防止触发表格行的点击事件
- **图标辅助**：所有菜单项右侧必须包含图标（Shortcut）
- **弹窗层级**：使用 `modal={false}` 避免弹窗层级问题

---

## 标准代码实现

```tsx
import { MoreHorizontal, Eye, Pencil, Trash2, Copy } from 'lucide-react'
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu'

// ... 在 columns 定义中
{
  id: 'actions',
  cell: ({ row }) => {
    const item = row.original

    return (
      <DropdownMenu modal={false}>
        <DropdownMenuTrigger asChild onClick={(e) => e.stopPropagation()}>
          <Button variant='ghost' className='h-8 w-8 p-0 data-[state=open]:bg-muted'>
            <span className='sr-only'>打开菜单</span>
            <MoreHorizontal className='h-4 w-4' />
          </Button>
        </DropdownMenuTrigger>
        
        <DropdownMenuContent align='end' className='w-[160px]'>
          {/* 1. 查看 - 对应 Sheet */}
          <DropdownMenuItem onClick={() => onView(item)}>
            查看详情
            <DropdownMenuShortcut><Eye size={14} /></DropdownMenuShortcut>
          </DropdownMenuItem>

          {/* 2. 编辑 - 对应 Dialog */}
          <DropdownMenuItem onClick={() => onEdit(item)}>
            编辑
            <DropdownMenuShortcut><Pencil size={14} /></DropdownMenuShortcut>
          </DropdownMenuItem>

          {/* 3. 业务操作（示例） */}
          <DropdownMenuItem onClick={() => handleCopy(item)}>
            复制ID
            <DropdownMenuShortcut><Copy size={14} /></DropdownMenuShortcut>
          </DropdownMenuItem>

          <DropdownMenuSeparator />

          {/* 4. 删除 - 危险操作 */}
          <DropdownMenuItem
            onClick={() => onDelete(item)}
            className='text-destructive focus:text-destructive focus:bg-destructive/10'
          >
            删除
            <DropdownMenuShortcut><Trash2 size={14} /></DropdownMenuShortcut>
          </DropdownMenuItem>
        </DropdownMenuContent>
      </DropdownMenu>
    )
  },
}
```

---

## 列定义接口规范

```tsx
interface ColumnsProps {
  onView: (item: ItemType) => void    // 查看详情 → Sheet
  onEdit: (item: ItemType) => void    // 编辑 → Dialog
  onDelete: (item: ItemType) => void  // 删除 → ConfirmDialog
}
```

---

## 删除操作样式

```tsx
// 删除菜单项样式
className='text-destructive focus:text-destructive focus:bg-destructive/10'
```

- `text-destructive`：红色文字
- `focus:text-destructive`：聚焦时保持红色
- `focus:bg-destructive/10`：聚焦时浅红色背景
