# ä¸šåŠ¡ä¸­å¿ƒæ”¹é€ è®¡åˆ’æ–‡æ¡£

> åŸºäºç»ˆç«¯é¢„è§ˆå™¨æœåŠ¡è¯¦æƒ…é¡µçš„åŠŸèƒ½å±•ç¤ºï¼Œå®Œå–„ä¸šåŠ¡ä¸­å¿ƒå¯¹åº”æ¨¡å—
> 
> **ç‰ˆæœ¬**ï¼šv2.0ï¼ˆå®¡è®¡ä¿®è®¢ç‰ˆï¼‰  
> **æ›´æ–°æ—¥æœŸ**ï¼š2024-12-11

---

## ä¸€ã€èƒŒæ™¯ä¸ç›®æ ‡

### 1.1 èƒŒæ™¯

ç»ˆç«¯é¢„è§ˆå™¨å·²å®ŒæˆæœåŠ¡è¯¦æƒ…é¡µçš„ UI è®¾è®¡ï¼ŒåŒ…å«ä»¥ä¸‹å±•ç¤ºå†…å®¹ï¼š

- æœåŠ¡åŸºæœ¬ä¿¡æ¯ï¼ˆåç§°ã€ä»·æ ¼ã€è¯„åˆ†ã€é”€é‡ï¼‰
- æœåŠ¡å›¾ç‰‡è½®æ’­ï¼ˆå°é¢å›¾ã€è¯¦æƒ…å›¾ï¼‰
- æœåŠ¡äº®ç‚¹ï¼ˆ4ä¸ªäº®ç‚¹æ ‡ç­¾ï¼‰
- æœåŠ¡æµç¨‹ï¼ˆæ­¥éª¤æµç¨‹å›¾ï¼‰
- æœåŠ¡å†…å®¹ï¼ˆå¯Œæ–‡æœ¬å›¾æ–‡ä»‹ç»ï¼‰
- æœåŠ¡é¡»çŸ¥ï¼ˆæ³¨æ„äº‹é¡¹åˆ—è¡¨ï¼‰
- æœåŠ¡ä¿éšœï¼ˆå¹³å°æ‹…ä¿ç­‰ï¼‰
- æ¨èæœåŠ¡ï¼ˆæ¨ªå‘å¡ç‰‡åˆ—è¡¨ï¼‰

ä½†ä¸šåŠ¡ä¸­å¿ƒçš„æœåŠ¡ç®¡ç†ç­‰æ¨¡å—å°šæœªå®Œå…¨æ”¯æŒè¿™äº›æ•°æ®çš„é…ç½®ï¼Œéœ€è¦è¿›è¡Œæ”¹é€ ã€‚

### 1.2 ç›®æ ‡

1. **æœåŠ¡ç®¡ç†**ï¼šæ”¯æŒå®Œæ•´çš„æœåŠ¡ä¿¡æ¯é…ç½®ï¼ŒåŒ…æ‹¬å›¾ç‰‡ä¸Šä¼ ã€å¯Œæ–‡æœ¬å†…å®¹ã€æµç¨‹å…³è”
2. **æµç¨‹ç®¡ç†**ï¼šå®ç°åç«¯ APIï¼Œæ”¯æŒæµç¨‹çš„åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤
3. **æ•°æ®è”åŠ¨**ï¼šæœåŠ¡ä¸æµç¨‹å…³è”ï¼Œé¢„è§ˆå™¨èƒ½å±•ç¤ºçœŸå®é…ç½®çš„æ•°æ®
4. **æè‡´ä½“éªŒ**ï¼šæ‰“é€ æµç•…ã€ç›´è§‚ã€ä¸“ä¸šçš„åå°ç®¡ç†ç•Œé¢

---

## äºŒã€ç°çŠ¶åˆ†æ

### 2.1 æ•°æ®åº“å­—æ®µå¯¹ç…§

| é¢„è§ˆå™¨å±•ç¤º | æ•°æ®åº“å­—æ®µ | åç«¯ DTO | å‰ç«¯è¡¨å• | çŠ¶æ€ |
|-----------|-----------|---------|---------|------|
| æœåŠ¡åç§° | `name` | âœ… | âœ… | å·²å®Œæˆ |
| æœåŠ¡æè¿° | `description` | âœ… | âœ… | å·²å®Œæˆ |
| é”€å”®ä»·æ ¼ | `price` | âœ… | âœ… | å·²å®Œæˆ |
| åŸä»· | `originalPrice` | âœ… | âœ… | å·²å®Œæˆ |
| è®¡ä»·å•ä½ | `unit` | âœ… | âœ… | å·²å®Œæˆ |
| æœåŠ¡æ—¶é•¿ | `duration` | âœ… | âœ… | å·²å®Œæˆ |
| å°é¢å›¾ | `coverImage` | âœ… | âŒ | éœ€å‰ç«¯å¯¹æ¥ |
| è¯¦æƒ…å›¾ | `detailImages` | âœ… | âŒ | éœ€å‰ç«¯å¯¹æ¥ |
| æœåŠ¡äº®ç‚¹ | `serviceIncludes` | âœ… | âœ… | UIæ ‡ç­¾éœ€ä¿®æ”¹ |
| æœåŠ¡é¡»çŸ¥ | `serviceNotes` | âœ… | âœ… | UIæ ‡ç­¾éœ€ä¿®æ”¹ |
| è¯„åˆ† | `rating` | âœ… | - | ç³»ç»Ÿè®¡ç®— |
| è®¢å•æ•° | `orderCount` | âœ… | - | ç³»ç»Ÿè®¡ç®— |
| **æœåŠ¡å†…å®¹** | `content` | âŒ | âŒ | éœ€æ–°å¢ |
| **å…³è”æµç¨‹** | `workflowId` | âŒ | âŒ | éœ€æ–°å¢ |

### 2.2 åŠŸèƒ½æ¨¡å—å¯¹ç…§

| æ¨¡å— | åç«¯ API | å‰ç«¯é¡µé¢ | çŠ¶æ€ |
|-----|---------|---------|------|
| æœåŠ¡ç®¡ç† | âœ… å®Œæ•´ | âš ï¸ ç¼ºå›¾ç‰‡ä¸Šä¼ ã€å¯Œæ–‡æœ¬ | éœ€å®Œå–„ |
| æœåŠ¡åˆ†ç±» | âœ… å®Œæ•´ | âœ… å®Œæ•´ | å·²å®Œæˆ |
| æµç¨‹ç®¡ç† | âŒ æ—  | âš ï¸ Mock æ•°æ® | éœ€å¼€å‘ |

### 2.3 é¢„è§ˆå™¨ API ç±»å‹é—®é¢˜

å½“å‰é¢„è§ˆå™¨ API ç±»å‹å®šä¹‰ä¸åç«¯ä¸ä¸€è‡´ï¼Œéœ€åŒæ­¥æ›´æ–°ï¼š

| é¢„è§ˆå™¨å­—æ®µ | åç«¯å­—æ®µ | é—®é¢˜ |
|-----------|---------|------|
| `images` | `detailImages` | å­—æ®µåä¸ä¸€è‡´ |
| `features` | `serviceIncludes` | å­—æ®µåå’Œç»“æ„ä¸ä¸€è‡´ |
| `notes` | `serviceNotes` | å­—æ®µåå’Œç»“æ„ä¸ä¸€è‡´ |

---

## ä¸‰ã€UI/UX è®¾è®¡è§„èŒƒ

### 3.1 è®¾è®¡åŸåˆ™

1. **ç›´è§‚æ€§**ï¼šç”¨æˆ·æ— éœ€å­¦ä¹ å³å¯ä¸Šæ‰‹
2. **å³æ—¶åé¦ˆ**ï¼šæ¯ä¸ªæ“ä½œéƒ½æœ‰æ˜ç¡®çš„è§†è§‰/è§¦è§‰åé¦ˆ
3. **å®¹é”™æ€§**ï¼šæ”¯æŒæ’¤é”€ã€è‡ªåŠ¨ä¿å­˜ã€å‹å¥½é”™è¯¯æç¤º
4. **ä¸€è‡´æ€§**ï¼šä¸ç°æœ‰ç®¡ç†åå°é£æ ¼ç»Ÿä¸€

### 3.2 äº¤äº’åŠ¨æ•ˆè§„èŒƒ

| åœºæ™¯ | åŠ¨æ•ˆ | æ—¶é•¿ |
|-----|------|-----|
| æŒ‰é’®æ‚¬åœ | scale(1.02) + é˜´å½± | 150ms |
| å¡ç‰‡æ‚¬åœ | translateY(-2px) + é˜´å½± | 200ms |
| å¼¹çª—å‡ºç° | fadeIn + scaleY(0.98â†’1) | 200ms |
| åˆ—è¡¨é¡¹æ·»åŠ  | slideDown + fadeIn | 250ms |
| åˆ—è¡¨é¡¹åˆ é™¤ | slideUp + fadeOut | 200ms |
| æ‹–æ‹½ä¸­ | scale(1.02) + é˜´å½± + é€æ˜åº¦0.9 | - |
| åŠ è½½çŠ¶æ€ | skeleton éª¨æ¶å± | - |
| æˆåŠŸæç¤º | toast ä»å³ä¸Šè§’æ»‘å…¥ | 3s è‡ªåŠ¨æ¶ˆå¤± |

### 3.3 é¢œè‰²ä¸çŠ¶æ€

```css
/* çŠ¶æ€é¢œè‰² */
--success: #22c55e;   /* æˆåŠŸ/å·²ä¸Šæ¶ */
--warning: #f59e0b;   /* è­¦å‘Š/è‰ç¨¿ */
--error: #ef4444;     /* é”™è¯¯/åˆ é™¤ */
--info: #3b82f6;      /* ä¿¡æ¯/ç¼–è¾‘ä¸­ */

/* æ‹–æ‹½çŠ¶æ€ */
--drag-source: rgba(59, 130, 246, 0.1);  /* è¢«æ‹–æ‹½é¡¹èƒŒæ™¯ */
--drag-target: rgba(34, 197, 94, 0.1);   /* æ”¾ç½®ç›®æ ‡èƒŒæ™¯ */
```

---

## å››ã€æ”¹é€ ä»»åŠ¡æ¸…å•

### 4.0 Phase 0ï¼šåŸºç¡€è®¾æ–½å‡†å¤‡ï¼ˆä¼˜å…ˆçº§ï¼šæœ€é«˜ï¼‰

#### ä»»åŠ¡ 0.1ï¼šé€šç”¨å›¾ç‰‡ä¸Šä¼ ç»„ä»¶

**ç›®æ ‡**ï¼šå°è£…å¯å¤ç”¨çš„å›¾ç‰‡ä¸Šä¼ ç»„ä»¶ï¼Œæ”¯æŒå•å›¾å’Œå¤šå›¾æ¨¡å¼

**ç»„ä»¶ API è®¾è®¡**ï¼š

```tsx
interface ImageUploadProps {
  value?: string | string[]
  onChange?: (value: string | string[]) => void
  
  // æ¨¡å¼
  multiple?: boolean          // æ˜¯å¦å¤šå›¾æ¨¡å¼
  maxCount?: number           // æœ€å¤§æ•°é‡ï¼ˆå¤šå›¾æ¨¡å¼ï¼‰
  
  // é™åˆ¶
  maxSize?: number            // å•å¼ æœ€å¤§å­—èŠ‚ï¼ˆé»˜è®¤ 5MBï¼‰
  accept?: string             // æ¥å—çš„æ ¼å¼
  aspectRatio?: number        // è£å‰ªæ¯”ä¾‹ï¼ˆå¯é€‰ï¼‰
  
  // äº¤äº’
  sortable?: boolean          // æ˜¯å¦å¯æ’åºï¼ˆå¤šå›¾æ¨¡å¼ï¼‰
  showPreview?: boolean       // æ˜¯å¦æ˜¾ç¤ºé¢„è§ˆæŒ‰é’®
  
  // æ ·å¼
  listType?: 'picture-card' | 'picture' | 'text'
  className?: string
}
```

**UI è®¾è®¡è¦ç‚¹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å°é¢å›¾ä¸Šä¼ ï¼ˆå•å›¾æ¨¡å¼ï¼‰                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚     â”‚   ğŸ–¼ï¸ é¢„è§ˆ   â”‚  â† æ‚¬åœæ˜¾ç¤ºæ“ä½œæŒ‰é’®                  â”‚
â”‚     â”‚             â”‚    [ğŸ‘ï¸ é¢„è§ˆ] [ğŸ—‘ï¸ åˆ é™¤]              â”‚
â”‚     â”‚  å·²ä¸Šä¼ å›¾ç‰‡  â”‚                                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                         â”‚
â”‚     æˆ–                                                   â”‚
â”‚                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚     â”‚     â•      â”‚  â† ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼                     â”‚
â”‚     â”‚   ä¸Šä¼ å›¾ç‰‡   â”‚                                     â”‚
â”‚     â”‚ æ”¯æŒjpg/png â”‚                                     â”‚
â”‚     â”‚   â‰¤5MB      â”‚                                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¯¦æƒ…å›¾ä¸Šä¼ ï¼ˆå¤šå›¾æ¨¡å¼ï¼Œå¯æ‹–æ‹½æ’åºï¼‰                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”                â”‚
â”‚  â”‚ 1  â”‚  â”‚ 2  â”‚  â”‚ 3  â”‚  â”‚ 4  â”‚  â”‚ â• â”‚                â”‚
â”‚  â”‚ ğŸ–¼ï¸ â”‚  â”‚ ğŸ–¼ï¸ â”‚  â”‚ ğŸ–¼ï¸ â”‚  â”‚ ğŸ–¼ï¸ â”‚  â”‚æ·»åŠ â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜                â”‚
â”‚    â†”ï¸ æ‹–æ‹½å¯æ’åº                      (4/9)             â”‚
â”‚                                                         â”‚
â”‚  æ‹–æ‹½æ’åºæ—¶ï¼š                                            â”‚
â”‚  - è¢«æ‹–é¡¹åŠé€æ˜ + æ”¾å¤§æ•ˆæœ                               â”‚
â”‚  - ç›®æ ‡ä½ç½®æ˜¾ç¤ºè“è‰²è™šçº¿å ä½                              â”‚
â”‚  - æ¾æ‰‹åå¹³æ»‘åŠ¨ç”»å½’ä½                                    â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸Šä¼ è¿‡ç¨‹äº¤äº’**ï¼š

```
1. é€‰æ‹©æ–‡ä»¶
   â””â”€ éªŒè¯æ ¼å¼ã€å¤§å°
      â”œâ”€ å¤±è´¥ â†’ toast é”™è¯¯æç¤º
      â””â”€ æˆåŠŸ â†’ è¿›å…¥ä¸Šä¼ 

2. ä¸Šä¼ ä¸­
   â””â”€ æ˜¾ç¤ºä¸Šä¼ è¿›åº¦æ¡ï¼ˆåº•éƒ¨è“è‰²æ¡ï¼‰
   â””â”€ å›¾ç‰‡æ˜¾ç¤º loading é®ç½©
   â””â”€ å¯ç‚¹å‡»å–æ¶ˆ

3. ä¸Šä¼ å®Œæˆ
   â”œâ”€ æˆåŠŸ â†’ æ¸å…¥æ˜¾ç¤º + å³ä¸‹è§’ç»¿è‰² âœ“
   â””â”€ å¤±è´¥ â†’ çº¢è‰²è¾¹æ¡† + é‡è¯•æŒ‰é’®
```

**æ–‡ä»¶ç»“æ„**ï¼š

```
src/components/image-upload/
â”œâ”€â”€ index.tsx              # ä¸»ç»„ä»¶
â”œâ”€â”€ upload-item.tsx        # å•ä¸ªå›¾ç‰‡é¡¹
â”œâ”€â”€ upload-trigger.tsx     # ä¸Šä¼ è§¦å‘å™¨
â”œâ”€â”€ preview-modal.tsx      # å›¾ç‰‡é¢„è§ˆå¼¹çª—
â””â”€â”€ use-upload.ts          # ä¸Šä¼  hook
```

**é¢„ä¼°å·¥æ—¶**ï¼š3h

---

#### ä»»åŠ¡ 0.2ï¼šé¢„è§ˆå™¨ API ç±»å‹åŒæ­¥

**ç›®æ ‡**ï¼šç»Ÿä¸€é¢„è§ˆå™¨ä¸åç«¯çš„ç±»å‹å®šä¹‰

**æ”¹åŠ¨å†…å®¹**ï¼š

```typescript
// src/components/terminal-preview/api.ts

// ä¿®æ”¹å‰
export interface ServiceDetail {
  images?: string[]           // âŒ
  features?: string[]         // âŒ
  notes?: string              // âŒ
}

// ä¿®æ”¹å
export interface ServiceDetail {
  detailImages?: string[]     // âœ… ä¸åç«¯ä¸€è‡´
  serviceIncludes?: Array<{   // âœ… ä¸åç«¯ä¸€è‡´
    text: string
    icon?: string
  }>
  serviceNotes?: Array<{      // âœ… ä¸åç«¯ä¸€è‡´
    title: string
    content: string
  }>
}
```

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `src/components/terminal-preview/api.ts`
- `src/components/terminal-preview/types.ts`
- `src/components/terminal-preview/components/pages/ServiceDetailPage.tsx`

**é¢„ä¼°å·¥æ—¶**ï¼š1.5h

---

### 4.1 Phase 1ï¼šæœåŠ¡ç®¡ç†å¢å¼ºï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

#### ä»»åŠ¡ 1.1ï¼šå›¾ç‰‡ä¸Šä¼ åŠŸèƒ½é›†æˆ

**ç›®æ ‡**ï¼šåœ¨æœåŠ¡ç®¡ç†è¡¨å•ä¸­é›†æˆå›¾ç‰‡ä¸Šä¼ 

**è¡¨å•å¸ƒå±€è®¾è®¡**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¦ æ·»åŠ æœåŠ¡                                       [X]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€ åŸºæœ¬ä¿¡æ¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚  æœåŠ¡åç§° *          æœåŠ¡åˆ†ç±» *                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚  â”‚ é—¨è¯Šé™ªè¯Š     â”‚    â”‚ é™ªè¯ŠæœåŠ¡ â–¼  â”‚            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚  æœåŠ¡ç®€ä»‹                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ ä¸“ä¸šé™ªè¯Šå¸ˆå…¨ç¨‹é™ªåŒå°±åŒ»...                â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€ æœåŠ¡å›¾ç‰‡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚  å°é¢å›¾                    è¯¦æƒ…å›¾ï¼ˆæœ€å¤š9å¼ ï¼‰     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚        â”‚               â”‚ 1  â”‚ â”‚ 2  â”‚ â”‚ â• â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  ğŸ–¼ï¸    â”‚               â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”‚        â”‚               â†”ï¸ æ‹–æ‹½æ’åº            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚   â”‚
â”‚  â”‚  å»ºè®®å°ºå¯¸: 750x500                              â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  [ç»§ç»­å¾€ä¸‹æ»šåŠ¨...]                                      â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              [å–æ¶ˆ]  [ä¿å­˜è‰ç¨¿]  [å‘å¸ƒ] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’ç»†èŠ‚**ï¼š

1. **å°é¢å›¾ä¸Šä¼ **
   - ç‚¹å‡»è§¦å‘æ–‡ä»¶é€‰æ‹©
   - æ”¯æŒæ‹–æ‹½åˆ°åŒºåŸŸ
   - ä¸Šä¼ æˆåŠŸåæ˜¾ç¤ºé¢„è§ˆ
   - æ‚¬åœæ˜¾ç¤º [æŸ¥çœ‹] [æ›´æ¢] [åˆ é™¤]

2. **è¯¦æƒ…å›¾ä¸Šä¼ **
   - å¤šå›¾æ¨¡å¼ï¼Œæœ€å¤š 9 å¼ 
   - æ”¯æŒæ‰¹é‡é€‰æ‹©
   - æ”¯æŒæ‹–æ‹½æ’åºï¼ˆä½¿ç”¨ @dnd-kit/sortableï¼‰
   - æ˜¾ç¤ºå½“å‰æ•°é‡ (n/9)
   - æ‹–æ‹½æ—¶æ˜¾ç¤ºæŠ•å½±æ•ˆæœ

**æ¶‰åŠæ–‡ä»¶**ï¼š
```
src/features/business/services/index.tsx
```

**é¢„ä¼°å·¥æ—¶**ï¼š2h

---

#### ä»»åŠ¡ 1.2ï¼šå¯Œæ–‡æœ¬ç¼–è¾‘å™¨

**ç›®æ ‡**ï¼šæœåŠ¡ç®¡ç†è¡¨å•æ”¯æŒå¯Œæ–‡æœ¬å†…å®¹ç¼–è¾‘

**æ•°æ®åº“æ”¹åŠ¨**ï¼š

```prisma
model Service {
  // ... ç°æœ‰å­—æ®µ
  content    String?  @db.Text  // å¯Œæ–‡æœ¬å†…å®¹ï¼ˆHTMLï¼‰
}
```

**ä¾èµ–å®‰è£…**ï¼š

```bash
pnpm add @tiptap/react @tiptap/pm @tiptap/starter-kit
pnpm add @tiptap/extension-image @tiptap/extension-link
pnpm add @tiptap/extension-placeholder @tiptap/extension-text-align
pnpm add @tiptap/extension-underline @tiptap/extension-color
pnpm add @tiptap/extension-text-style
pnpm add dompurify @types/dompurify  # XSS é˜²æŠ¤
```

**ç¼–è¾‘å™¨ UI è®¾è®¡**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœåŠ¡å†…å®¹                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [B] [I] [U] â”‚ [H1] [H2] â”‚ [â€¢] [1.] â”‚ [ğŸ”—] [ğŸ–¼ï¸] â”‚   â”‚  â† å·¥å…·æ 
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚  åœ¨è¿™é‡Œç¼–è¾‘æœåŠ¡çš„è¯¦ç»†ä»‹ç»...                    â”‚   â”‚  â† å ä½æç¤º
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚  æ”¯æŒï¼š                                         â”‚   â”‚
â”‚  â”‚  - å¯Œæ–‡æœ¬æ ¼å¼ï¼ˆåŠ ç²—ã€æ–œä½“ã€ä¸‹åˆ’çº¿ï¼‰            â”‚   â”‚
â”‚  â”‚  - æ ‡é¢˜æ ·å¼                                     â”‚   â”‚
â”‚  â”‚  - æœ‰åº/æ— åºåˆ—è¡¨                               â”‚   â”‚
â”‚  â”‚  - æ’å…¥å›¾ç‰‡                                     â”‚   â”‚
â”‚  â”‚  - æ’å…¥é“¾æ¥                                     â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                          å­—æ•°ï¼š0/5000   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å·¥å…·æ åŠŸèƒ½è®¾è®¡**ï¼š

| å›¾æ ‡ | åŠŸèƒ½ | å¿«æ·é”® |
|-----|------|-------|
| **B** | ç²—ä½“ | Ctrl+B |
| *I* | æ–œä½“ | Ctrl+I |
| <u>U</u> | ä¸‹åˆ’çº¿ | Ctrl+U |
| H1 | ä¸€çº§æ ‡é¢˜ | Ctrl+Alt+1 |
| H2 | äºŒçº§æ ‡é¢˜ | Ctrl+Alt+2 |
| â€¢ | æ— åºåˆ—è¡¨ | - |
| 1. | æœ‰åºåˆ—è¡¨ | - |
| ğŸ”— | æ’å…¥é“¾æ¥ | Ctrl+K |
| ğŸ–¼ï¸ | æ’å…¥å›¾ç‰‡ | - |

**æ’å…¥å›¾ç‰‡äº¤äº’**ï¼š

```
ç‚¹å‡» [ğŸ–¼ï¸] æŒ‰é’®
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ’å…¥å›¾ç‰‡                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           â”‚
â”‚  â—‹ ä¸Šä¼ æœ¬åœ°å›¾ç‰‡            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚     â• é€‰æ‹©å›¾ç‰‡   â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚
â”‚  â—‹ è¾“å…¥å›¾ç‰‡é“¾æ¥            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚ https://...     â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚
â”‚          [å–æ¶ˆ]  [æ’å…¥]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç»„ä»¶æ–‡ä»¶ç»“æ„**ï¼š

```
src/components/rich-editor/
â”œâ”€â”€ index.tsx              # ä¸»ç¼–è¾‘å™¨ç»„ä»¶
â”œâ”€â”€ toolbar.tsx            # å·¥å…·æ 
â”œâ”€â”€ extensions/
â”‚   â”œâ”€â”€ image.ts           # å›¾ç‰‡æ‰©å±•ï¼ˆæ”¯æŒä¸Šä¼ ï¼‰
â”‚   â””â”€â”€ link.ts            # é“¾æ¥æ‰©å±•
â”œâ”€â”€ menu-items/
â”‚   â”œâ”€â”€ bold.tsx
â”‚   â”œâ”€â”€ italic.tsx
â”‚   â”œâ”€â”€ heading.tsx
â”‚   â”œâ”€â”€ list.tsx
â”‚   â”œâ”€â”€ image-button.tsx
â”‚   â””â”€â”€ link-button.tsx
â””â”€â”€ styles.css             # ç¼–è¾‘å™¨æ ·å¼
```

**æ¶‰åŠæ–‡ä»¶**ï¼š
```
server/prisma/schema.prisma
server/src/modules/services/dto/service.dto.ts
server/src/modules/services/services.service.ts
src/features/business/services/index.tsx
src/components/rich-editor/  (æ–°å»º)
```

**é¢„ä¼°å·¥æ—¶**ï¼š5h

---

#### ä»»åŠ¡ 1.3ï¼šæœ¯è¯­ç»Ÿä¸€

**ç›®æ ‡**ï¼šç»Ÿä¸€æœåŠ¡ç®¡ç†ä¸­çš„å­—æ®µæ˜¾ç¤ºåç§°

| UI ä½ç½® | å½“å‰åç§° | æ”¹ä¸º | å¤‡æ³¨ |
|--------|---------|-----|------|
| è¡¨å•åŒºå—æ ‡é¢˜ | æœåŠ¡ä¿éšœ | æœåŠ¡äº®ç‚¹ | ä¸é¢„è§ˆå™¨ä¸€è‡´ |
| è¡¨å•åŒºå—æ ‡é¢˜ | é¢„è®¢é¡»çŸ¥ | æœåŠ¡é¡»çŸ¥ | ä¸é¢„è§ˆå™¨ä¸€è‡´ |
| è¯¦æƒ…å¼¹çª— | æœåŠ¡ä¿éšœ | æœåŠ¡äº®ç‚¹ | ä¸é¢„è§ˆå™¨ä¸€è‡´ |
| è¯¦æƒ…å¼¹çª— | é¢„è®¢é¡»çŸ¥ | æœåŠ¡é¡»çŸ¥ | ä¸é¢„è§ˆå™¨ä¸€è‡´ |

**æ³¨æ„**ï¼šåªä¿®æ”¹ UI æ˜¾ç¤ºæ ‡ç­¾ï¼Œä¸ä¿®æ”¹æ•°æ®åº“å­—æ®µå

**æ¶‰åŠæ–‡ä»¶**ï¼š
```
src/features/business/services/index.tsx
```

**é¢„ä¼°å·¥æ—¶**ï¼š0.5h

---

### 4.2 Phase 2ï¼šæµç¨‹ç®¡ç†å®ç°ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

#### ä»»åŠ¡ 2.1ï¼šæ•°æ®åº“è®¾è®¡

**æ–°å¢è¡¨**ï¼š

```prisma
// æµç¨‹æ¨¡æ¿
model Workflow {
  id          String         @id @default(uuid())
  name        String
  description String?
  category    String         // æµç¨‹åˆ†ç±»ï¼šé™ªè¯Šæµç¨‹ã€è¯Šæ–­æµç¨‹ã€è·‘è…¿æµç¨‹ã€å”®åæµç¨‹
  status      String         @default("active")  // active, inactive, draft
  usageCount  Int            @default(0) @map("usage_count")
  createdAt   DateTime       @default(now()) @map("created_at")
  updatedAt   DateTime       @updatedAt @map("updated_at")

  steps       WorkflowStep[]
  services    Service[]      // å…³è”çš„æœåŠ¡

  @@map("workflows")
}

// æµç¨‹æ­¥éª¤
model WorkflowStep {
  id          String   @id @default(uuid())
  workflowId  String   @map("workflow_id")
  name        String
  description String?  // æ­¥éª¤æè¿°
  type        String   // start, action, condition, end
  sort        Int      @default(0)
  createdAt   DateTime @default(now()) @map("created_at")

  workflow    Workflow @relation(fields: [workflowId], references: [id], onDelete: Cascade)

  @@map("workflow_steps")
}
```

**Service è¡¨å…³è”**ï¼š

```prisma
model Service {
  // ... ç°æœ‰å­—æ®µ
  content      String?   @db.Text
  workflowId   String?   @map("workflow_id")
  workflow     Workflow? @relation(fields: [workflowId], references: [id])
}
```

**é¢„ä¼°å·¥æ—¶**ï¼š0.5h

---

#### ä»»åŠ¡ 2.2ï¼šåç«¯ API å®ç°

**æ–°å¢æ¨¡å—**ï¼š`server/src/modules/workflows/`

**API åˆ—è¡¨**ï¼š

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|-----|------|-----|
| GET | `/workflows` | è·å–æµç¨‹åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€åˆ†ç±»ç­›é€‰ï¼‰ |
| GET | `/workflows/:id` | è·å–æµç¨‹è¯¦æƒ…ï¼ˆå«æ­¥éª¤ï¼‰ |
| POST | `/workflows` | åˆ›å»ºæµç¨‹ï¼ˆå«æ­¥éª¤ï¼‰ |
| PUT | `/workflows/:id` | æ›´æ–°æµç¨‹ï¼ˆå«æ­¥éª¤ï¼‰ |
| DELETE | `/workflows/:id` | åˆ é™¤æµç¨‹ |
| PATCH | `/workflows/:id/status` | æ›´æ–°æµç¨‹çŠ¶æ€ |
| GET | `/workflows/active` | è·å–å¯ç”¨çš„æµç¨‹ï¼ˆç”¨äºä¸‹æ‹‰é€‰æ‹©ï¼‰ |

**DTO è®¾è®¡**ï¼š

```typescript
// æ­¥éª¤ DTO
class WorkflowStepDto {
  @IsString()
  name: string

  @IsOptional()
  @IsString()
  description?: string

  @IsEnum(['start', 'action', 'condition', 'end'])
  type: string

  @IsInt()
  sort: number
}

// åˆ›å»ºæµç¨‹ DTO
class CreateWorkflowDto {
  @IsString()
  @MinLength(2)
  @MaxLength(50)
  name: string

  @IsOptional()
  @IsString()
  description?: string

  @IsString()
  category: string

  @IsArray()
  @ValidateNested({ each: true })
  @Type(() => WorkflowStepDto)
  steps: WorkflowStepDto[]

  @IsOptional()
  @IsEnum(['active', 'inactive', 'draft'])
  status?: string
}
```

**æ–‡ä»¶ç»“æ„**ï¼š
```
server/src/modules/workflows/
â”œâ”€â”€ workflows.module.ts
â”œâ”€â”€ workflows.controller.ts
â”œâ”€â”€ workflows.service.ts
â””â”€â”€ dto/
    â””â”€â”€ workflow.dto.ts
```

**é¢„ä¼°å·¥æ—¶**ï¼š4h

---

#### ä»»åŠ¡ 2.3ï¼šå‰ç«¯å¯¹æ¥çœŸå® API

**ç›®æ ‡**ï¼šæµç¨‹ç®¡ç†é¡µé¢ä» Mock æ•°æ®æ”¹ä¸ºçœŸå® API

**API Hooks**ï¼š

```typescript
// src/hooks/use-api.ts æ–°å¢

export const useWorkflows = (params?: QueryWorkflowDto) => 
  useQuery(['workflows', params], () => api.getWorkflows(params))

export const useWorkflow = (id: string) =>
  useQuery(['workflow', id], () => api.getWorkflow(id))

export const useActiveWorkflows = () =>
  useQuery(['workflows', 'active'], () => api.getActiveWorkflows())

export const useCreateWorkflow = () =>
  useMutation(api.createWorkflow, { onSuccess: () => invalidate(['workflows']) })

export const useUpdateWorkflow = () =>
  useMutation(api.updateWorkflow, { onSuccess: () => invalidate(['workflows']) })

export const useDeleteWorkflow = () =>
  useMutation(api.deleteWorkflow, { onSuccess: () => invalidate(['workflows']) })
```

**æ¶‰åŠæ–‡ä»¶**ï¼š
```
src/lib/api.ts
src/hooks/use-api.ts
src/features/business/workflows/index.tsx
```

**é¢„ä¼°å·¥æ—¶**ï¼š2h

---

#### ä»»åŠ¡ 2.4ï¼šæµç¨‹æ­¥éª¤ç¼–è¾‘å™¨ï¼ˆé‡ç‚¹ UIï¼‰

**ç›®æ ‡**ï¼šå®ç°å¯è§†åŒ–çš„æµç¨‹æ­¥éª¤ç¼–è¾‘å™¨

**ä¾èµ–å®‰è£…**ï¼š

```bash
pnpm add @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities
```

**ç¼–è¾‘å™¨ UI è®¾è®¡**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‹ ç¼–è¾‘æµç¨‹                                       [X]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  æµç¨‹åç§° *                  æµç¨‹åˆ†ç±»                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ æ ‡å‡†é™ªè¯Šæµç¨‹     â”‚        â”‚ é™ªè¯Šæµç¨‹ â–¼      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                         â”‚
â”‚  æµç¨‹æè¿°                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é—¨è¯Šé™ªè¯Šæ ‡å‡†æœåŠ¡æµç¨‹...                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€ æµç¨‹æ­¥éª¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚  â¬‡ï¸ æ‹–æ‹½è°ƒæ•´é¡ºåº                                 â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ â‹®â‹®  ğŸŸ¢ å¼€å§‹  â”‚ ç”¨æˆ·ä¸‹å•        â”‚ [âœï¸] [ğŸ—‘ï¸] â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                     â”‚                           â”‚   â”‚
â”‚  â”‚                     â–¼                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ â‹®â‹®  ğŸ”µ åŠ¨ä½œ  â”‚ é™ªè¯Šå‘˜æ¥å•      â”‚ [âœï¸] [ğŸ—‘ï¸] â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                     â”‚                           â”‚   â”‚
â”‚  â”‚                     â–¼                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ â‹®â‹®  ğŸ”µ åŠ¨ä½œ  â”‚ åˆ°è¾¾åŒ»é™¢        â”‚ [âœï¸] [ğŸ—‘ï¸] â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                     â”‚                           â”‚   â”‚
â”‚  â”‚                     â–¼                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ â‹®â‹®  ğŸŸ£ ç»“æŸ  â”‚ æœåŠ¡å®Œæˆ        â”‚ [âœï¸] [ğŸ—‘ï¸] â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚           â• æ·»åŠ æ­¥éª¤                    â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              [å–æ¶ˆ]  [ä¿å­˜è‰ç¨¿]  [å‘å¸ƒ] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ­¥éª¤ç±»å‹ä¸é¢œè‰²**ï¼š

| ç±»å‹ | é¢œè‰² | å›¾æ ‡ | è¯´æ˜ |
|-----|------|-----|------|
| start | ğŸŸ¢ ç»¿è‰² | â–¶ï¸ | æµç¨‹å¼€å§‹ |
| action | ğŸ”µ è“è‰² | âš¡ | æ‰§è¡ŒåŠ¨ä½œ |
| condition | ğŸŸ¡ é»„è‰² | â“ | æ¡ä»¶åˆ¤æ–­ |
| end | ğŸŸ£ ç´«è‰² | ğŸ | æµç¨‹ç»“æŸ |

**ç¼–è¾‘æ­¥éª¤å¼¹çª—**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¼–è¾‘æ­¥éª¤                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚  æ­¥éª¤åç§° *                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é™ªè¯Šå‘˜æ¥å•           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚
â”‚  æ­¥éª¤ç±»å‹                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â—‹ ğŸŸ¢ å¼€å§‹           â”‚   â”‚
â”‚  â”‚ â— ğŸ”µ åŠ¨ä½œ           â”‚   â”‚
â”‚  â”‚ â—‹ ğŸŸ¡ æ¡ä»¶           â”‚   â”‚
â”‚  â”‚ â—‹ ğŸŸ£ ç»“æŸ           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚
â”‚  æ­¥éª¤æè¿°ï¼ˆå¯é€‰ï¼‰            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é™ªè¯Šå‘˜ç¡®è®¤è®¢å•å¹¶...   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚
â”‚            [å–æ¶ˆ]  [ç¡®å®š]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ‹–æ‹½äº¤äº’ç»†èŠ‚**ï¼š

1. **æ‹–æ‹½å¼€å§‹**ï¼š
   - è¢«æ‹–é¡¹ scale(1.02) + boxShadow åŠ æ·±
   - è¢«æ‹–é¡¹é€æ˜åº¦ 0.9
   - æ˜¾ç¤ºæ‹–æ‹½æ‰‹æŸ„é«˜äº®

2. **æ‹–æ‹½ä¸­**ï¼š
   - åŸä½ç½®æ˜¾ç¤ºè™šçº¿å ä½æ¡†
   - ç›®æ ‡ä½ç½®æ˜¾ç¤ºè“è‰²è™šçº¿æŒ‡ç¤º
   - å…¶ä»–é¡¹å¹³æ»‘è¿‡æ¸¡è®©ä½

3. **æ‹–æ‹½ç»“æŸ**ï¼š
   - å¹³æ»‘åŠ¨ç”»å½’ä½ï¼ˆ200msï¼‰
   - è§¦å‘æ’åºæ›´æ–°

**ç»„ä»¶æ–‡ä»¶ç»“æ„**ï¼š

```
src/components/workflow-editor/
â”œâ”€â”€ index.tsx              # ä¸»ç¼–è¾‘å™¨
â”œâ”€â”€ step-item.tsx          # æ­¥éª¤é¡¹ï¼ˆå¯æ‹–æ‹½ï¼‰
â”œâ”€â”€ step-form.tsx          # æ­¥éª¤ç¼–è¾‘è¡¨å•
â”œâ”€â”€ step-type-select.tsx   # ç±»å‹é€‰æ‹©å™¨
â”œâ”€â”€ add-step-button.tsx    # æ·»åŠ æŒ‰é’®
â””â”€â”€ styles.css             # æ ·å¼
```

**æ¶‰åŠæ–‡ä»¶**ï¼š
```
src/features/business/workflows/index.tsx
src/components/workflow-editor/ (æ–°å»º)
```

**é¢„ä¼°å·¥æ—¶**ï¼š3h

---

### 4.3 Phase 3ï¼šæœåŠ¡å…³è”æµç¨‹ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

#### ä»»åŠ¡ 3.1ï¼šæœåŠ¡ç®¡ç†è¡¨å•æ·»åŠ æµç¨‹é€‰æ‹©

**ç›®æ ‡**ï¼šåœ¨æœåŠ¡è¡¨å•ä¸­å¯ä»¥é€‰æ‹©å…³è”çš„æµç¨‹

**UI è®¾è®¡**ï¼š

```
â”Œâ”€ æœåŠ¡æµç¨‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                     â”‚
â”‚  å…³è”æµç¨‹                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â–¼ é€‰æ‹©æµç¨‹ï¼ˆå¯é€‰ï¼‰                          â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚   â”‚ ğŸ” æœç´¢æµç¨‹...                      â”‚   â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚   â”‚ ğŸ“‚ é™ªè¯Šæµç¨‹                          â”‚   â”‚   â”‚
â”‚  â”‚   â”‚   â”œâ”€ âœ“ æ ‡å‡†é™ªè¯Šæµç¨‹                 â”‚   â”‚   â”‚
â”‚  â”‚   â”‚   â””â”€ â—‹ VIPé™ªè¯Šæµç¨‹                  â”‚   â”‚   â”‚
â”‚  â”‚   â”‚ ğŸ“‚ è·‘è…¿æµç¨‹                          â”‚   â”‚   â”‚
â”‚  â”‚   â”‚   â””â”€ â—‹ è¯å“ä»£è´­æµç¨‹                 â”‚   â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                     â”‚
â”‚  å·²é€‰ï¼šæ ‡å‡†é™ªè¯Šæµç¨‹                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ç”¨æˆ·ä¸‹å• â†’ é™ªè¯Šå‘˜æ¥å• â†’ åˆ°è¾¾åŒ»é™¢ â†’ æœåŠ¡å®Œæˆ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’ç»†èŠ‚**ï¼š

1. ä¸‹æ‹‰é€‰æ‹©å¯ç”¨çš„æµç¨‹
2. æŒ‰åˆ†ç±»åˆ†ç»„æ˜¾ç¤º
3. æ”¯æŒæœç´¢è¿‡æ»¤
4. é€‰ä¸­åæ˜¾ç¤ºæµç¨‹æ­¥éª¤é¢„è§ˆ
5. å¯æ¸…é™¤å·²é€‰æµç¨‹

**æ¶‰åŠæ–‡ä»¶**ï¼š
```
src/features/business/services/index.tsx
```

**é¢„ä¼°å·¥æ—¶**ï¼š1.5h

---

#### ä»»åŠ¡ 3.2ï¼šé¢„è§ˆå™¨å±•ç¤ºå…³è”æµç¨‹

**ç›®æ ‡**ï¼šæœåŠ¡è¯¦æƒ… API è¿”å›å…³è”çš„æµç¨‹æ•°æ®ï¼Œé¢„è§ˆå™¨æ­£ç¡®å±•ç¤º

**åç«¯æ”¹åŠ¨**ï¼š

```typescript
// services.service.ts
async findOne(id: string) {
  return this.prisma.service.findUnique({
    where: { id },
    include: {
      category: true,
      workflow: {          // æ–°å¢ï¼šå…³è”æµç¨‹
        include: {
          steps: {
            orderBy: { sort: 'asc' }
          }
        }
      }
    },
  });
}
```

**é¢„è§ˆå™¨æ”¹åŠ¨**ï¼š

- è¯»å– `service.workflow.steps` æ›¿ä»£ mock æ•°æ®
- æ— æµç¨‹æ—¶æ˜¾ç¤ºç©ºçŠ¶æ€æˆ–éšè—è¯¥åŒºå—

**æ¶‰åŠæ–‡ä»¶**ï¼š
```
server/src/modules/services/services.service.ts
src/components/terminal-preview/api.ts
src/components/terminal-preview/components/pages/ServiceDetailPage.tsx
```

**é¢„ä¼°å·¥æ—¶**ï¼š1.5h

---

### 4.4 Phase 4ï¼šå…¨å±€é…ç½®ï¼ˆä¼˜å…ˆçº§ï¼šä½ï¼‰

#### ä»»åŠ¡ 4.1ï¼šæœåŠ¡ä¿éšœé…ç½®åŒ–

**ç›®æ ‡**ï¼šå°†"å¹³å°æ‹…ä¿ã€å…ˆæœåŠ¡åä»˜æ¬¾ã€å¥½è¯„è¿”ç°"åšæˆå…¨å±€é…ç½®

**é…ç½®ç»“æ„**ï¼š

```typescript
interface ServiceGuaranteeConfig {
  enabled: boolean
  items: Array<{
    icon: string
    title: string
    description: string
  }>
}
```

**UI è®¾è®¡**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ›¡ï¸ æœåŠ¡ä¿éšœé…ç½®                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  [âœ“] å¯ç”¨æœåŠ¡ä¿éšœå±•ç¤º                                   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â‹®â‹®  ğŸ›¡ï¸  â”‚ å¹³å°æ‹…ä¿    â”‚ èµ„é‡‘æ‰˜ç®¡ï¼ŒæœåŠ¡å®Œæˆåç»“ç®— â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â‹®â‹®  ğŸ’°  â”‚ å…ˆæœåŠ¡åä»˜æ¬¾ â”‚ æœåŠ¡æ»¡æ„åå†ç¡®è®¤ä»˜æ¬¾    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â‹®â‹®  ğŸ  â”‚ å¥½è¯„è¿”ç°     â”‚ äº”æ˜Ÿå¥½è¯„è¿”ç°5å…ƒ         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  [â• æ·»åŠ ä¿éšœé¡¹]                                         â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        [é‡ç½®]  [ä¿å­˜]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¶‰åŠæ–‡ä»¶**ï¼š
```
src/features/app-settings/homepage/index.tsx  (æˆ–æ–°å»ºæœåŠ¡é…ç½®é¡µ)
server/src/modules/config/config.service.ts
src/components/terminal-preview/components/pages/ServiceDetailPage.tsx
```

**é¢„ä¼°å·¥æ—¶**ï¼š1.5h

---

## äº”ã€æ‰§è¡Œè®¡åˆ’

### 5.1 å¼€å‘é¡ºåº

```
Phase 0ï¼ˆåŸºç¡€è®¾æ–½ï¼‰
â”œâ”€â”€ 0.1 é€šç”¨å›¾ç‰‡ä¸Šä¼ ç»„ä»¶       [3h]
â””â”€â”€ 0.2 é¢„è§ˆå™¨ API ç±»å‹åŒæ­¥    [1.5h]

Phase 1ï¼ˆæœåŠ¡ç®¡ç†å¢å¼ºï¼‰
â”œâ”€â”€ 1.1 å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½é›†æˆ       [2h]
â”œâ”€â”€ 1.2 å¯Œæ–‡æœ¬ç¼–è¾‘å™¨           [5h]
â””â”€â”€ 1.3 æœ¯è¯­ç»Ÿä¸€               [0.5h]

Phase 2ï¼ˆæµç¨‹ç®¡ç†å®ç°ï¼‰
â”œâ”€â”€ 2.1 æ•°æ®åº“è®¾è®¡             [0.5h]
â”œâ”€â”€ 2.2 åç«¯ API å®ç°          [4h]
â”œâ”€â”€ 2.3 å‰ç«¯å¯¹æ¥çœŸå® API       [2h]
â””â”€â”€ 2.4 æµç¨‹æ­¥éª¤ç¼–è¾‘å™¨         [3h]

Phase 3ï¼ˆæœåŠ¡å…³è”æµç¨‹ï¼‰
â”œâ”€â”€ 3.1 è¡¨å•æ·»åŠ æµç¨‹é€‰æ‹©       [1.5h]
â””â”€â”€ 3.2 é¢„è§ˆå™¨å±•ç¤ºå…³è”æµç¨‹     [1.5h]

Phase 4ï¼ˆå¯é€‰ï¼‰
â””â”€â”€ 4.1 æœåŠ¡ä¿éšœé…ç½®åŒ–         [1.5h]
```

### 5.2 æ€»å·¥æ—¶é¢„ä¼°

| Phase | å·¥æ—¶ | è¯´æ˜ |
|-------|-----|------|
| Phase 0 | 4.5h | åŸºç¡€è®¾æ–½ |
| Phase 1 | 7.5h | æœåŠ¡ç®¡ç†å¢å¼º |
| Phase 2 | 9.5h | æµç¨‹ç®¡ç†å®ç° |
| Phase 3 | 3h | æœåŠ¡å…³è”æµç¨‹ |
| Phase 4 | 1.5h | å¯é€‰é¡¹ |
| **æ€»è®¡** | **26h** | çº¦ **3-4 ä¸ªå·¥ä½œæ—¥** |

---

## å…­ã€æŠ€æœ¯æ–¹æ¡ˆ

### 6.1 ä¾èµ–æ¸…å•

**æ–°å¢ npm åŒ…**ï¼š

```bash
# å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
pnpm add @tiptap/react @tiptap/pm @tiptap/starter-kit
pnpm add @tiptap/extension-image @tiptap/extension-link
pnpm add @tiptap/extension-placeholder @tiptap/extension-text-align
pnpm add @tiptap/extension-underline

# XSS é˜²æŠ¤
pnpm add dompurify
pnpm add -D @types/dompurify

# æ‹–æ‹½æ’åº
pnpm add @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities
```

### 6.2 å›¾ç‰‡ä¸Šä¼ è§„èŒƒ

| é¡¹ç›® | è§„èŒƒ |
|-----|------|
| æ”¯æŒæ ¼å¼ | jpg, jpeg, png, webp |
| å•å¼ å¤§å°é™åˆ¶ | â‰¤ 5MB |
| å°é¢å›¾å»ºè®®å°ºå¯¸ | 750 Ã— 500 px |
| è¯¦æƒ…å›¾æœ€å¤§æ•°é‡ | 9 å¼  |
| ä¸Šä¼ æ¥å£ | POST /upload |
| è¿”å›æ ¼å¼ | `{ url: string }` |

### 6.3 å¯Œæ–‡æœ¬å®‰å…¨

```typescript
// æ¸²æŸ“å¯Œæ–‡æœ¬æ—¶ä½¿ç”¨ DOMPurify è¿‡æ»¤
import DOMPurify from 'dompurify'

const safeHtml = DOMPurify.sanitize(htmlContent, {
  ALLOWED_TAGS: ['p', 'br', 'strong', 'em', 'u', 'h1', 'h2', 'h3', 'ul', 'ol', 'li', 'a', 'img'],
  ALLOWED_ATTR: ['href', 'src', 'alt', 'class'],
})
```

---

## ä¸ƒã€éªŒæ”¶æ ‡å‡†

### 7.1 å›¾ç‰‡ä¸Šä¼ 

- [ ] å°é¢å›¾ï¼šæ”¯æŒå•å¼ ä¸Šä¼ ï¼Œé™åˆ¶ 5MBï¼Œæ”¯æŒ jpg/png/webp
- [ ] è¯¦æƒ…å›¾ï¼šæ”¯æŒå¤šå¼ ä¸Šä¼ ï¼ˆæœ€å¤š 9 å¼ ï¼‰ï¼Œæ”¯æŒæ‹–æ‹½æ’åº
- [ ] ä¸Šä¼ ä¸­æ˜¾ç¤ºè¿›åº¦ï¼Œå¤±è´¥æ˜¾ç¤ºé”™è¯¯å¹¶æ”¯æŒé‡è¯•
- [ ] æ‚¬åœå›¾ç‰‡æ˜¾ç¤ºé¢„è§ˆã€åˆ é™¤æŒ‰é’®
- [ ] æ‹–æ‹½æ’åºæœ‰å¹³æ»‘åŠ¨ç”»æ•ˆæœ

### 7.2 å¯Œæ–‡æœ¬ç¼–è¾‘å™¨

- [ ] æ”¯æŒï¼šç²—ä½“ã€æ–œä½“ã€ä¸‹åˆ’çº¿
- [ ] æ”¯æŒï¼šH1ã€H2 æ ‡é¢˜
- [ ] æ”¯æŒï¼šæœ‰åº/æ— åºåˆ—è¡¨
- [ ] æ”¯æŒï¼šæ’å…¥å›¾ç‰‡ï¼ˆä¸Šä¼ /é“¾æ¥ï¼‰
- [ ] æ”¯æŒï¼šæ’å…¥é“¾æ¥
- [ ] å·¥å…·æ  UI ç¾è§‚ï¼Œä¸æ•´ä½“é£æ ¼ç»Ÿä¸€
- [ ] è¾“å…¥æœ‰å ä½æç¤º
- [ ] å­—æ•°ç»Ÿè®¡

### 7.3 æµç¨‹ç®¡ç†

- [ ] å¯åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤æµç¨‹
- [ ] æµç¨‹æ­¥éª¤å¯æ‹–æ‹½æ’åº
- [ ] æ­¥éª¤ç±»å‹å¯é€‰ï¼ˆå¼€å§‹/åŠ¨ä½œ/æ¡ä»¶/ç»“æŸï¼‰
- [ ] æ¯ç§ç±»å‹æœ‰ä¸åŒé¢œè‰²æ ‡è¯†
- [ ] å¯å¯ç”¨/åœç”¨æµç¨‹
- [ ] æ•°æ®æ­£ç¡®æŒä¹…åŒ–

### 7.4 æ•°æ®è”åŠ¨

- [ ] æœåŠ¡å¯å…³è”æµç¨‹
- [ ] æµç¨‹ä¸‹æ‹‰æŒ‰åˆ†ç±»åˆ†ç»„
- [ ] é¢„è§ˆå™¨æ­£ç¡®å±•ç¤ºå…³è”çš„æµç¨‹æ­¥éª¤
- [ ] æ— æµç¨‹æ—¶éšè—è¯¥åŒºå—æˆ–æ˜¾ç¤ºç©ºçŠ¶æ€

### 7.5 æ•´ä½“ä½“éªŒ

- [ ] æ‰€æœ‰æ“ä½œæœ‰å³æ—¶åé¦ˆï¼ˆloadingã€toastï¼‰
- [ ] åŠ¨ç”»æµç•…ï¼Œæ— å¡é¡¿
- [ ] é”™è¯¯æç¤ºå‹å¥½æ˜ç¡®
- [ ] æ”¯æŒé”®ç›˜å¿«æ·é”®ï¼ˆå¯Œæ–‡æœ¬ï¼‰

---

## å…«ã€é£é™©ä¸æ³¨æ„äº‹é¡¹

| é£é™© | æ¦‚ç‡ | å½±å“ | ç¼“è§£æªæ–½ |
|-----|-----|-----|---------|
| æ•°æ®åº“è¿ç§»å¤±è´¥ | ä½ | é«˜ | å…ˆåœ¨å¼€å‘ç¯å¢ƒæµ‹è¯•ï¼Œå‡†å¤‡å›æ»š SQL |
| TipTap å…¼å®¹æ€§ | ä½ | ä¸­ | é™åˆ¶æœ€ä½ Chrome 80+ï¼Œæä¾›é™çº§æ–¹æ¡ˆ |
| å¯Œæ–‡æœ¬ XSS | é«˜ | é«˜ | å‰ç«¯ä½¿ç”¨ DOMPurify è¿‡æ»¤ |
| å›¾ç‰‡ä¸Šä¼ å¤±è´¥ | ä¸­ | ä¸­ | å®ç°è‡ªåŠ¨é‡è¯• + é”™è¯¯æç¤º |
| æ‹–æ‹½æ€§èƒ½ï¼ˆå¤§é‡æ­¥éª¤ï¼‰ | ä½ | ä½ | é™åˆ¶æ­¥éª¤æ•°é‡ï¼ˆâ‰¤20ï¼‰ |

---

## é™„å½•

### A. ç›¸å…³æ–‡ä»¶æ¸…å•

```
# æ–°å¢é€šç”¨ç»„ä»¶
src/components/image-upload/
src/components/rich-editor/
src/components/workflow-editor/

# æ•°æ®åº“
server/prisma/schema.prisma

# åç«¯ - æœåŠ¡æ¨¡å—
server/src/modules/services/services.service.ts
server/src/modules/services/services.controller.ts
server/src/modules/services/dto/service.dto.ts

# åç«¯ - æµç¨‹æ¨¡å—ï¼ˆæ–°å»ºï¼‰
server/src/modules/workflows/

# å‰ç«¯ - æœåŠ¡ç®¡ç†
src/features/business/services/index.tsx

# å‰ç«¯ - æµç¨‹ç®¡ç†
src/features/business/workflows/index.tsx

# å‰ç«¯ - API
src/lib/api.ts
src/hooks/use-api.ts

# é¢„è§ˆå™¨
src/components/terminal-preview/api.ts
src/components/terminal-preview/types.ts
src/components/terminal-preview/components/pages/ServiceDetailPage.tsx
```

### B. å‚è€ƒèµ„æ–™

- [TipTap å®˜æ–¹æ–‡æ¡£](https://tiptap.dev/)
- [dnd-kit å®˜æ–¹æ–‡æ¡£](https://dndkit.com/)
- [DOMPurify æ–‡æ¡£](https://github.com/cure53/DOMPurify)
- [Prisma è¿ç§»æŒ‡å—](https://www.prisma.io/docs/concepts/components/prisma-migrate)
- [ç»ˆç«¯å…¨å±€é¢„è§ˆå™¨ç»„ä»¶å¼€å‘æ–‡æ¡£](./ç»ˆç«¯å…¨å±€é¢„è§ˆå™¨ç»„ä»¶å¼€å‘æ–‡æ¡£.md)
